# 脚本选择
本小节将大致介绍当程序开始运行时，lua部分是如何决定运行Play文件夹下的哪个脚本的。当用户在config的操作台中给出IS_TEST_MODE = true/false、gTestPlay = ""或OPPONENT_NAME = ""后，启动代码，大致决策流程如下：

```lua
--进入SelectPlay.lua
if 有裁判盒指令 then
    转到OPPONENT下的某个NormalKick脚本，此脚本由config里的OPPONENT_NAME决定
    在NormalKick脚本中由裁判盒指令决定运行哪个Ref或Nor脚本
else 
    if IS_TEST_MODE then
        转到Play下的某个Test脚本，此脚本由config里的gTestPlay决定
        运行Test脚本
    else
        转到OPPONENT下的某个NormalKick脚本，此脚本由config里的OPPONENT_NAME决定
        没有裁判盒指令，自动运行NormalKick里的NorPlay = Nor_xxx脚本
```

## Select Play
在程序开始运行时，先运行SelectPlay.lua，判断运行哪个脚本。如果是TestMode则运行config里指定的test脚本（即gTestPlay = ""），如果不是TestMode则运行config里指定的NormalKick脚本（即OPPONENT_NAME = ""）

```lua
---------------------------------------
--选play--gCurrentPlay在config中指定
--------------------------------------
if SelectRefPlay() then --有裁判盒指令此时一定运行NormalKick脚本
	...
else --没有裁判盒指令
	if IS_TEST_MODE then --if在测试模式下，IS_TEST_MODE接config，运行config脚本
		...
	else --不在测试模式，一般为比赛模式，运行NormalKick脚本
		...
	end
end
```
选定脚本后，把脚本名字赋值给gCurrentPlay，通过RunPlay(gCurrentPlay)运行脚本。此处一般会接Test系列脚本或比赛时的NormalKick脚本

# Opponent
opponent中的NormalKick系列脚本用于比赛期间，当裁判盒发出指令后，根据接收到的指令判断运行Play文件夹下Ref系列哪个脚本，例如：

```lua
gOppoConfig = {
    ------------------------------play-----------------------------------
    
        CornerKick  = {"Ref_CornerKick_show"},
        FrontKick   = {"Ref_FrontKick_show"},
        MiddleKick  = {"Ref_MiddleKick_show"},
        BackKick    = {"Ref_BackKick_show"},
        
    -------------------------------Def-----------------------------------
    
        CornerDef   = "Ref_CornerDef_show",
        FrontDef    = "Ref_FrontDef_show",
        MiddleDef   = "Ref_MiddleDef_show",
        BackDef 	= "Ref_BackDef_show",
    
    -------------------------------Special-------------------------------
    
        PenaltyKick = "Ref_PenaltyKick_normal",
        PenaltyDef  = "Ref_PenaltyDef_normal",
    
        KickOff		= "Ref_KickOff_show",
        KickOffDef  = "Ref_KickOffDef_show",
        
        NorPlay     = "Nor_4_show",
    }
```